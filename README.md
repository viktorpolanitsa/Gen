# The Gentoo Genesis Engine

**Версия:** 10.3.12 "The Prophylactic"
**Автор:** viktorpolanitsa
**Лицензия:** MIT

**The Gentoo Genesis Engine** — это продвинутый, интеллектуальный и полностью автоматизированный установщик операционной системы Gentoo Linux. Он превращает сложный, многочасовой процесс ручной установки по официальному руководству (Handbook) в простую процедуру, управляемую удобным мастером настройки.

Скрипт спроектирован с упором на максимальную надежность, безопасность и гибкость, позволяя как новичкам, так и опытным пользователям получить готовую к работе, оптимизированную систему Gentoo за минимальное время.

## Философия проекта

Установка Gentoo — это мощный инструмент для создания системы, идеально подогнанной под ваше оборудование и задачи. Однако этот процесс требует высокой концентрации, десятков команд и нескольких часов времени. **Genesis Engine** автоматизирует всю рутину, оставляя вам только принятие ключевых решений.

Наша философия:
1.  **Надежность превыше всего:** Скрипт должен предвидеть проблемы (нехватка памяти, отсутствие утилит, ошибки пользователя) и решать их до того, как они приведут к сбою.
2.  **Автоматизация лучших практик:** Все действия скрипта (разметка диска, настройка Portage, конфигурация загрузчика) основаны на официальной документации и лучших практиках сообщества Gentoo.
3.  **Полный контроль для пользователя:** Автоматизация не должна означать «черный ящик». Интерактивный мастер дает вам полный контроль над всеми важными аспектами будущей системы.

## Ключевые возможности

-   **Интеллектуальное определение оборудования:** Автоматически определяет ваш CPU (Intel/AMD) и GPU (Nvidia/AMD/Intel), подбирая оптимальные `CFLAGS`, `-march` и драйверы.
-   **Система чекпоинтов:** Если установка прервется, ее можно **продолжить с того же места**, не начиная все сначала.
-   **Самовосстановление LiveCD:** Скрипт обнаруживает недостающие утилиты на LiveCD, **автоматически создает ZRAM-swap** для предотвращения сбоев из-за нехватки ОЗУ и доустанавливает все необходимое.
-   **Гибкий интерактивный мастер:** Удобный пошаговый конфигуратор для всех аспектов системы.
-   **Безопасность по умолчанию:** Встроенная поддержка полного шифрования диска **LUKS2**, включая опцию шифрования `/boot` для максимальной защиты.
-   **Полная кастомизация:** Поддержка **UEFI/Legacy**, **LVM**, различных файловых систем (**Btrfs, XFS, Ext4**), систем инициализации (**OpenRC, SystemD**) и сред рабочего стола.
-   **Автоматизация после установки:** Создает пользователя, настраивает `sudo`, устанавливает выбранные наборы ПО и даже может настроить еженедельное автоматическое обновление системы.

## Системные опции и возможности

Вы можете настроить практически каждый аспект вашей будущей системы:

### Архитектура и Безопасность
-   **Профиль системы:** Стандартный или **Hardened** для повышенной безопасности.
-   **Система инициализации:** **OpenRC** или **SystemD**.
-   **Модули безопасности Linux (LSM):** **AppArmor**, **SELinux** или отсутствие.
-   **Брандмауэр:** Автоматическая настройка базовых правил с помощью **UFW**.

### Система хранения
-   **Файловая система:** **Btrfs** (по умолчанию, с подтомами `@` и `@home`), **XFS** или **Ext4**.
-   **Менеджер логических томов (LVM):** Возможность использовать LVM для гибкого управления разделами.
-   **Полное шифрование диска (LUKS):** Надежное шифрование корневого раздела с использованием LUKS2.
-   **Шифрование `/boot`:** Максимальный уровень безопасности с шифрованием загрузочного раздела (требует UEFI и LVM).
-   **Отдельный `/home`:** Возможность создать отдельный раздел для домашних каталогов (требует LVM).
-   **Swap:** Традиционный **swap-раздел**, **ZRAM** (в ОЗУ) или полное отсутствие.

### Среды рабочего стола
-   **KDE Plasma**
-   **GNOME**
-   **XFCE**
-   **i3-wm** (минималистичный оконный менеджер)
-   **Серверный профиль** (без графического интерфейса)

### Управление ядром
- **`genkernel`:** Полностью автоматическая сборка (рекомендуется).
- **`gentoo-kernel`:** Дистрибутивное ядро с готовой конфигурацией.
- **`gentoo-kernel-bin`:** Прекомпилированное бинарное ядро для максимальной скорости установки.
- **Ручная настройка:** Для экспертов, желающих настроить ядро самостоятельно.

### Оптимизация производительности
- **`ccache`:** Включение кеширования для ускорения последующих компиляций.
- **Бинарные пакеты:** Использование предсобранных пакетов для ускорения установки (если доступны).
- **Link-Time Optimization (LTO):** Экспериментальная опция для оптимизации на уровне всей системы.

### Наборы программного обеспечения
- **Универсальный хост приложений:** Flatpak + Distrobox.
- **"Кибернетический терминал":** Zsh + Starship.
- **Инструменты разработчика:** Git, VSCode, Docker.
- **Офис и графика:** LibreOffice, GIMP, Inkscape.
- **Игровой набор:** Steam, Lutris, Wine.

### Дополнительные возможности
- **Автоматическое обновление:** Настройка еженедельного обновления системы.
- **Среды загрузки (Boot Environments):** Атомарные обновления и откаты системы (требует Btrfs).
- **Интеллектуальное управление частотой CPU:** Для ноутбуков, для баланса производительности и энергосбережения.

## Требования

1.  **Gentoo LiveCD** или любой другой загрузочный Linux-дистрибутив с доступом в интернет.
2.  **Стабильное интернет-соединение.**
3.  Базовое понимание, как именуются диски в Linux (например, `/dev/sda`, `/dev/nvme0n1`).

## Как использовать

### Шаг 1: Загрузка скрипта

Загрузитесь с LiveCD, откройте терминал и получите права `root`:
```bash
sudo -i
```
Скачайте последнюю версию скрипта из этого репозитория:
```bash
wget https://raw.githubusercontent.com/viktorpolanitsa/Gen/refs/heads/main/Praxis.sh
```

Сделайте скрипт исполняемым:
```bash
chmod +x Praxis.sh
```

### Шаг 2: Запуск и настройка

Запустите скрипт. **Настоятельно рекомендуется** использовать `tee` для сохранения полного лога установки в файл. Это бесценно для отладки в случае проблем.

```bash
bash Praxis.sh | tee gentoo_install.log
```
*Или, если `chmod +x` был выполнен:*
```bash
./Praxis.sh | tee gentoo_install.log
```

Скрипт проведет самодиагностику, определит ваше оборудование и запустит интерактивный мастер. Внимательно отвечайте на вопросы.

### Шаг 3: Завершение

После того как скрипт завершит работу, вы увидите сообщение об успешной установке. Вам останется только выполнить три команды:

```bash
exit
umount -R /mnt/gentoo
reboot
```

После перезагрузки вы сможете войти в вашу новую, готовую к работе систему Gentoo!

## Аргументы командной строки

-   `--force` или `--auto`: Пропускает все вопросы `[y/N]`, автоматически отвечая "да". **Используйте с осторожностью!**
-   `--skip-checksum`: Отключает проверку целостности скачанного архива `stage3`. Не рекомендуется, но может быть полезно в изолированных сетях.

## Восстановление после сбоя

Если установка прервалась (например, из-за отключения электричества), просто перезагрузитесь с LiveCD и запустите скрипт снова. Он обнаружит незавершенную установку и предложит вам выбор:

- **[C]ontinue:** Продолжить с того шага, на котором произошел сбой.
- **[R]estart:** Полностью стереть предыдущую попытку и начать с нуля.
- **[A]bort:** Прервать выполнение.

## ⚠️ ВАЖНОЕ ПРЕДУПРЕЖДЕНИЕ

> **ЭТОТ СКРИПТ УНИЧТОЖИТ ВСЕ ДАННЫЕ НА ВЫБРАННОМ ВАМИ ДИСКЕ.**
>
> Автор не несет ответственности за потерю данных. Внимательно проверяйте, какой диск (`/dev/sda`, `/dev/nvme0n1` и т.д.) вы указываете в мастере установки. Создайте резервные копии всех важных файлов перед использованием. Вы используете этот скрипт на свой страх и риск.

Вклад в проект

Мы приветствуем любой вклад! Если вы нашли ошибку, у вас есть идея по улучшению или вы хотите добавить новую возможность, пожалуйста, создайте `Issue` или `Pull Request` в этом репозитории.

Лицензия

Этот проект распространяется под лицензией MIT. Подробности смотрите в файле `LICENSE`.

---
*Счастливой компиляции!*
